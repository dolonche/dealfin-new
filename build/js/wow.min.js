!function(e,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.WOW=n.exports}}(this,function(e,t){"use strict";var n,i;function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function a(e,t){return t.indexOf(e)>=0}function r(e,t,n){null!=e.addEventListener?e.addEventListener(t,n,!1):null!=e.attachEvent?e.attachEvent("on"+t,n):e[t]=n}function l(e,t,n){null!=e.removeEventListener?e.removeEventListener(t,n,!1):null!=e.detachEvent?e.detachEvent("on"+t,n):delete e[t]}var u=window.WeakMap||window.MozWeakMap||function(){function e(){o(this,e),this.keys=[],this.values=[]}return s(e,[{key:"get",value:function(e){for(var t=0;t<this.keys.length;t++){if(this.keys[t]===e)return this.values[t]}}},{key:"set",value:function(e,t){for(var n=0;n<this.keys.length;n++){if(this.keys[n]===e)return this.values[n]=t,this}return this.keys.push(e),this.values.push(t),this}}]),e}(),c=window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver||(i=n=function(){function e(){o(this,e),"undefined"!=typeof console&&null!==console&&(console.warn("MutationObserver is not supported by your browser."),console.warn("WOW.js cannot detect dom mutations, please call .sync() after loading new content."))}return s(e,[{key:"observe",value:function(){}}]),e}(),n.notSupported=!0,i),h=window.getComputedStyle||function(e){var t=/(\-([a-z]){1})/g;return{getPropertyValue:function(n){"float"===n&&(n="styleFloat"),t.test(n)&&n.replace(t,function(e,t){return t.toUpperCase()});var i=e.currentStyle;return(null!=i?i[n]:void 0)||null}}},d=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,e),this.defaults={boxClass:"wow",animateClass:"animated",offset:0,mobile:!0,live:!0,callback:null,scrollContainer:null,resetAnimation:!0},this.animate="requestAnimationFrame"in window?function(e){return window.requestAnimationFrame(e)}:function(e){return e()},this.vendors=["moz","webkit"],this.start=this.start.bind(this),this.resetAnimation=this.resetAnimation.bind(this),this.scrollHandler=this.scrollHandler.bind(this),this.scrollCallback=this.scrollCallback.bind(this),this.scrolled=!0,this.config=function(e,t){for(var n in t)if(null==e[n]){var i=t[n];e[n]=i}return e}(t,this.defaults),null!=t.scrollContainer&&(this.config.scrollContainer=document.querySelector(t.scrollContainer)),this.animationNameCache=new u,this.wowEvent=function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],n=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],i=arguments.length<=3||void 0===arguments[3]?null:arguments[3],o=void 0;return null!=document.createEvent?(o=document.createEvent("CustomEvent")).initCustomEvent(e,t,n,i):null!=document.createEventObject?(o=document.createEventObject()).eventType=e:o.eventName=e,o}(this.config.boxClass)}return s(e,[{key:"init",value:function(){this.element=window.document.documentElement,a(document.readyState,["interactive","complete"])?this.start():r(document,"DOMContentLoaded",this.start),this.finished=[]}},{key:"start",value:function(){var e=this;if(this.stopped=!1,this.boxes=[].slice.call(this.element.querySelectorAll("."+this.config.boxClass)),this.all=this.boxes.slice(0),this.boxes.length)if(this.disabled())this.resetStyle();else for(var t=0;t<this.boxes.length;t++){var n=this.boxes[t];this.applyStyle(n,!0)}(this.disabled()||(r(this.config.scrollContainer||window,"scroll",this.scrollHandler),r(window,"resize",this.scrollHandler),this.interval=setInterval(this.scrollCallback,50)),this.config.live)&&new c(function(t){for(var n=0;n<t.length;n++)for(var i=t[n],o=0;o<i.addedNodes.length;o++){var s=i.addedNodes[o];e.doSync(s)}}).observe(document.body,{childList:!0,subtree:!0})}},{key:"stop",value:function(){this.stopped=!0,l(this.config.scrollContainer||window,"scroll",this.scrollHandler),l(window,"resize",this.scrollHandler),null!=this.interval&&clearInterval(this.interval)}},{key:"sync",value:function(){c.notSupported&&this.doSync(this.element)}},{key:"doSync",value:function(e){if(void 0!==e&&null!==e||(e=this.element),1===e.nodeType)for(var t=(e=e.parentNode||e).querySelectorAll("."+this.config.boxClass),n=0;n<t.length;n++){var i=t[n];a(i,this.all)||(this.boxes.push(i),this.all.push(i),this.stopped||this.disabled()?this.resetStyle():this.applyStyle(i,!0),this.scrolled=!0)}}},{key:"show",value:function(e){var t,n;return this.applyStyle(e),e.className=e.className+" "+this.config.animateClass,null!=this.config.callback&&this.config.callback(e),t=e,n=this.wowEvent,null!=t.dispatchEvent?t.dispatchEvent(n):n in(null!=t)?t[n]():"on"+n in(null!=t)&&t["on"+n](),this.config.resetAnimation&&(r(e,"animationend",this.resetAnimation),r(e,"oanimationend",this.resetAnimation),r(e,"webkitAnimationEnd",this.resetAnimation),r(e,"MSAnimationEnd",this.resetAnimation)),e}},{key:"applyStyle",value:function(e,t){var n=this,i=e.getAttribute("data-wow-duration"),o=e.getAttribute("data-wow-delay"),s=e.getAttribute("data-wow-iteration");return this.animate(function(){return n.customStyle(e,t,i,o,s)})}},{key:"resetStyle",value:function(){for(var e=0;e<this.boxes.length;e++){this.boxes[e].style.visibility="visible"}}},{key:"resetAnimation",value:function(e){if(e.type.toLowerCase().indexOf("animationend")>=0){var t=e.target||e.srcElement;t.className=t.className.replace(this.config.animateClass,"").trim()}}},{key:"customStyle",value:function(e,t,n,i,o){return t&&this.cacheAnimationName(e),e.style.visibility=t?"hidden":"visible",n&&this.vendorSet(e.style,{animationDuration:n}),i&&this.vendorSet(e.style,{animationDelay:i}),o&&this.vendorSet(e.style,{animationIterationCount:o}),this.vendorSet(e.style,{animationName:t?"none":this.cachedAnimationName(e)}),e}},{key:"vendorSet",value:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];e[""+n]=i;for(var o=0;o<this.vendors.length;o++){e[""+this.vendors[o]+n.charAt(0).toUpperCase()+n.substr(1)]=i}}}},{key:"vendorCSS",value:function(e,t){for(var n=h(e),i=n.getPropertyCSSValue(t),o=0;o<this.vendors.length;o++){var s=this.vendors[o];i=i||n.getPropertyCSSValue("-"+s+"-"+t)}return i}},{key:"animationName",value:function(e){var t=void 0;try{t=this.vendorCSS(e,"animation-name").cssText}catch(n){t=h(e).getPropertyValue("animation-name")}return"none"===t?"":t}},{key:"cacheAnimationName",value:function(e){return this.animationNameCache.set(e,this.animationName(e))}},{key:"cachedAnimationName",value:function(e){return this.animationNameCache.get(e)}},{key:"scrollHandler",value:function(){this.scrolled=!0}},{key:"scrollCallback",value:function(){if(this.scrolled){this.scrolled=!1;for(var e=[],t=0;t<this.boxes.length;t++){var n=this.boxes[t];if(n){if(this.isVisible(n)){this.show(n);continue}e.push(n)}}this.boxes=e,this.boxes.length||this.config.live||this.stop()}}},{key:"offsetTop",value:function(e){for(;void 0===e.offsetTop;)e=e.parentNode;for(var t=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}},{key:"isVisible",value:function(e){var t=e.getAttribute("data-wow-offset")||this.config.offset,n=this.config.scrollContainer&&this.config.scrollContainer.scrollTop||window.pageYOffset,i=n+Math.min(this.element.clientHeight,"innerHeight"in window?window.innerHeight:document.documentElement.clientHeight)-t,o=this.offsetTop(e),s=o+e.clientHeight;return o<=i&&s>=n}},{key:"disabled",value:function(){return!this.config.mobile&&(e=navigator.userAgent,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e));var e}}]),e}();t.default=d,e.exports=t.default});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndvdy5qcyJdLCJuYW1lcyI6WyJnbG9iYWwiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsIm1vZCIsIldPVyIsInRoaXMiLCJfY2xhc3MiLCJfdGVtcCIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJwcm90b3R5cGUiLCJpc0luIiwibmVlZGxlIiwiaGF5c3RhY2siLCJpbmRleE9mIiwiYWRkRXZlbnQiLCJlbGVtIiwiZXZlbnQiLCJmbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJhdHRhY2hFdmVudCIsInJlbW92ZUV2ZW50IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImRldGFjaEV2ZW50IiwiV2Vha01hcCIsIndpbmRvdyIsIk1veldlYWtNYXAiLCJrZXlzIiwidmFsdWVzIiwicHVzaCIsIk11dGF0aW9uT2JzZXJ2ZXIiLCJXZWJraXRNdXRhdGlvbk9ic2VydmVyIiwiTW96TXV0YXRpb25PYnNlcnZlciIsImNvbnNvbGUiLCJ3YXJuIiwibm90U3VwcG9ydGVkIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImVsIiwiZ2V0Q29tcHV0ZWRTdHlsZVJYIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInByb3AiLCJ0ZXN0IiwicmVwbGFjZSIsIl8iLCJfY2hhciIsInRvVXBwZXJDYXNlIiwiY3VycmVudFN0eWxlIiwib3B0aW9ucyIsImFyZ3VtZW50cyIsInVuZGVmaW5lZCIsImRlZmF1bHRzIiwiYm94Q2xhc3MiLCJhbmltYXRlQ2xhc3MiLCJvZmZzZXQiLCJtb2JpbGUiLCJsaXZlIiwiY2FsbGJhY2siLCJzY3JvbGxDb250YWluZXIiLCJyZXNldEFuaW1hdGlvbiIsImFuaW1hdGUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ2ZW5kb3JzIiwic3RhcnQiLCJiaW5kIiwic2Nyb2xsSGFuZGxlciIsInNjcm9sbENhbGxiYWNrIiwic2Nyb2xsZWQiLCJjb25maWciLCJjdXN0b20iLCJleHRlbmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhbmltYXRpb25OYW1lQ2FjaGUiLCJ3b3dFdmVudCIsImJ1YmJsZSIsImNhbmNlbCIsImRldGFpbCIsImN1c3RvbUV2ZW50IiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJjcmVhdGVFdmVudE9iamVjdCIsImV2ZW50VHlwZSIsImV2ZW50TmFtZSIsImVsZW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJyZWFkeVN0YXRlIiwiZmluaXNoZWQiLCJfdGhpcyIsInN0b3BwZWQiLCJib3hlcyIsInNsaWNlIiwiY2FsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhbGwiLCJkaXNhYmxlZCIsInJlc2V0U3R5bGUiLCJib3giLCJhcHBseVN0eWxlIiwiaW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInJlY29yZHMiLCJqIiwicmVjb3JkIiwiayIsImFkZGVkTm9kZXMiLCJub2RlIiwiZG9TeW5jIiwib2JzZXJ2ZSIsImJvZHkiLCJjaGlsZExpc3QiLCJzdWJ0cmVlIiwiY2xlYXJJbnRlcnZhbCIsIm5vZGVUeXBlIiwiaXRlcmFibGUiLCJwYXJlbnROb2RlIiwiY2xhc3NOYW1lIiwiZGlzcGF0Y2hFdmVudCIsImhpZGRlbiIsIl90aGlzMiIsImR1cmF0aW9uIiwiZ2V0QXR0cmlidXRlIiwiZGVsYXkiLCJpdGVyYXRpb24iLCJjdXN0b21TdHlsZSIsInN0eWxlIiwidmlzaWJpbGl0eSIsInR5cGUiLCJ0b0xvd2VyQ2FzZSIsInNyY0VsZW1lbnQiLCJ0cmltIiwiY2FjaGVBbmltYXRpb25OYW1lIiwidmVuZG9yU2V0IiwiYW5pbWF0aW9uRHVyYXRpb24iLCJhbmltYXRpb25EZWxheSIsImFuaW1hdGlvbkl0ZXJhdGlvbkNvdW50IiwiYW5pbWF0aW9uTmFtZSIsImNhY2hlZEFuaW1hdGlvbk5hbWUiLCJwcm9wZXJ0aWVzIiwibmFtZSIsImhhc093blByb3BlcnR5IiwiY2hhckF0Iiwic3Vic3RyIiwicHJvcGVydHkiLCJyZXN1bHQiLCJnZXRQcm9wZXJ0eUNTU1ZhbHVlIiwidmVuZG9yIiwiYU5hbWUiLCJ2ZW5kb3JDU1MiLCJjc3NUZXh0IiwiZXJyb3IiLCJzZXQiLCJnZXQiLCJyZXN1bHRzIiwiaXNWaXNpYmxlIiwic2hvdyIsInN0b3AiLCJvZmZzZXRUb3AiLCJ0b3AiLCJvZmZzZXRQYXJlbnQiLCJ2aWV3VG9wIiwic2Nyb2xsVG9wIiwicGFnZVlPZmZzZXQiLCJ2aWV3Qm90dG9tIiwiTWF0aCIsIm1pbiIsImNsaWVudEhlaWdodCIsImlubmVySGVpZ2h0IiwiYm90dG9tIiwiYWdlbnQiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJkZWZhdWx0Il0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFXQSxFQUFRQyxHQUNqQixHQUFzQixtQkFBWEMsUUFBeUJBLE9BQU9DLElBQ3pDRCxRQUFRLFNBQVUsV0FBWUQsUUFDekIsR0FBdUIsb0JBQVpHLFFBQ2hCSCxFQUFRSSxPQUFRRCxhQUNYLENBQ0wsSUFBSUUsR0FDRkYsWUFFRkgsRUFBUUssRUFBS0EsRUFBSUYsU0FDakJKLEVBQU9PLElBQU1ELEVBQUlGLFNBVnJCLENBWUdJLEtBQU0sU0FBVUgsRUFBUUQsR0FDekIsYUFNQSxJQUFJSyxFQUFRQyxFQUVaLFNBQVNDLEVBQWdCQyxFQUFVQyxHQUNqQyxLQUFNRCxhQUFvQkMsR0FDeEIsTUFBTSxJQUFJQyxVQUFVLHFDQVJ4QkMsT0FBT0MsZUFBZVosRUFBUyxjQUM3QmEsT0FBTyxJQVdULElBQUlDLEVBQWUsV0FDakIsU0FBU0MsRUFBaUJDLEVBQVFDLEdBQ2hDLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQ3JDLElBQUlFLEVBQWFILEVBQU1DLEdBQ3ZCRSxFQUFXQyxXQUFhRCxFQUFXQyxhQUFjLEVBQ2pERCxFQUFXRSxjQUFlLEVBQ3RCLFVBQVdGLElBQVlBLEVBQVdHLFVBQVcsR0FDakRaLE9BQU9DLGVBQWVJLEVBQVFJLEVBQVdJLElBQUtKLElBSWxELE9BQU8sU0FBVVgsRUFBYWdCLEVBQVlDLEdBR3hDLE9BRklELEdBQVlWLEVBQWlCTixFQUFZa0IsVUFBV0YsR0FDcERDLEdBQWFYLEVBQWlCTixFQUFhaUIsR0FDeENqQixHQWRRLEdBa0JuQixTQUFTbUIsRUFBS0MsRUFBUUMsR0FDcEIsT0FBT0EsRUFBU0MsUUFBUUYsSUFBVyxFQWtEckMsU0FBU0csRUFBU0MsRUFBTUMsRUFBT0MsR0FDQSxNQUF6QkYsRUFBS0csaUJBRVBILEVBQUtHLGlCQUFpQkYsRUFBT0MsR0FBSSxHQUNKLE1BQXBCRixFQUFLSSxZQUVkSixFQUFLSSxZQUFZLEtBQU9ILEVBQU9DLEdBRy9CRixFQUFLQyxHQUFTQyxFQUlsQixTQUFTRyxFQUFZTCxFQUFNQyxFQUFPQyxHQUNBLE1BQTVCRixFQUFLTSxvQkFFUE4sRUFBS00sb0JBQW9CTCxFQUFPQyxHQUFJLEdBQ1AsTUFBcEJGLEVBQUtPLFlBRWRQLEVBQUtPLFlBQVksS0FBT04sRUFBT0MsVUFHeEJGLEVBQUtDLEdBYWhCLElBQUlPLEVBQVVDLE9BQU9ELFNBQVdDLE9BQU9DLFlBQWMsV0FDbkQsU0FBU0YsSUFDUGxDLEVBQWdCSCxLQUFNcUMsR0FFdEJyQyxLQUFLd0MsUUFDTHhDLEtBQUt5QyxVQThCUCxPQTNCQS9CLEVBQWEyQixJQUNYakIsSUFBSyxNQUNMWCxNQUFPLFNBQWFXLEdBQ2xCLElBQUssSUFBSU4sRUFBSSxFQUFHQSxFQUFJZCxLQUFLd0MsS0FBS3pCLE9BQVFELElBQUssQ0FFekMsR0FEV2QsS0FBS3dDLEtBQUsxQixLQUNSTSxFQUNYLE9BQU9wQixLQUFLeUMsT0FBTzNCLE9BTXpCTSxJQUFLLE1BQ0xYLE1BQU8sU0FBYVcsRUFBS1gsR0FDdkIsSUFBSyxJQUFJSyxFQUFJLEVBQUdBLEVBQUlkLEtBQUt3QyxLQUFLekIsT0FBUUQsSUFBSyxDQUV6QyxHQURXZCxLQUFLd0MsS0FBSzFCLEtBQ1JNLEVBRVgsT0FEQXBCLEtBQUt5QyxPQUFPM0IsR0FBS0wsRUFDVlQsS0FLWCxPQUZBQSxLQUFLd0MsS0FBS0UsS0FBS3RCLEdBQ2ZwQixLQUFLeUMsT0FBT0MsS0FBS2pDLEdBQ1ZULFNBSUpxQyxFQW5DNEMsR0F1Q2pETSxFQUFtQkwsT0FBT0ssa0JBQW9CTCxPQUFPTSx3QkFBMEJOLE9BQU9PLHNCQUF3QjNDLEVBQVFELEVBQVMsV0FDakksU0FBUzBDLElBQ1B4QyxFQUFnQkgsS0FBTTJDLEdBRUMsb0JBQVpHLFNBQXVDLE9BQVpBLFVBQ3BDQSxRQUFRQyxLQUFLLHNEQUNiRCxRQUFRQyxLQUFLLHVGQVNqQixPQUxBckMsRUFBYWlDLElBQ1h2QixJQUFLLFVBQ0xYLE1BQU8sZ0JBR0ZrQyxFQWYwSCxHQWdCOUgxQyxFQUFPK0MsY0FBZSxFQUFNOUMsR0FHN0IrQyxFQUFtQlgsT0FBT1csa0JBQW9CLFNBQTBCQyxHQUMxRSxJQUFJQyxFQUFxQixrQkFDekIsT0FDRUMsaUJBQWtCLFNBQTBCQyxHQUM3QixVQUFUQSxJQUNGQSxFQUFPLGNBRUxGLEVBQW1CRyxLQUFLRCxJQUMxQkEsRUFBS0UsUUFBUUosRUFBb0IsU0FBVUssRUFBR0MsR0FDNUMsT0FBT0EsRUFBTUMsZ0JBR2pCLElBQUlDLEVBQWVULEVBQUdTLGFBRXRCLE9BQXdCLE1BQWhCQSxFQUF1QkEsRUFBYU4sUUFBUSxJQUFXLFFBS2pFdEQsRUFBTSxXQUNSLFNBQVNBLElBQ1AsSUFBSTZELEVBQVVDLFVBQVU5QyxRQUFVLFFBQXNCK0MsSUFBakJELFVBQVUsTUFBd0JBLFVBQVUsR0FFbkYxRCxFQUFnQkgsS0FBTUQsR0FFdEJDLEtBQUsrRCxVQUNIQyxTQUFVLE1BQ1ZDLGFBQWMsV0FDZEMsT0FBUSxFQUNSQyxRQUFRLEVBQ1JDLE1BQU0sRUFDTkMsU0FBVSxLQUNWQyxnQkFBaUIsS0FDakJDLGdCQUFnQixHQUdsQnZFLEtBQUt3RSxRQUNDLDBCQUEyQmxDLE9BQ3RCLFNBQVUrQixHQUNmLE9BQU8vQixPQUFPbUMsc0JBQXNCSixJQUdqQyxTQUFVQSxHQUNmLE9BQU9BLEtBSVhyRSxLQUFLMEUsU0FBVyxNQUFPLFVBRXZCMUUsS0FBSzJFLE1BQVEzRSxLQUFLMkUsTUFBTUMsS0FBSzVFLE1BQzdCQSxLQUFLdUUsZUFBaUJ2RSxLQUFLdUUsZUFBZUssS0FBSzVFLE1BQy9DQSxLQUFLNkUsY0FBZ0I3RSxLQUFLNkUsY0FBY0QsS0FBSzVFLE1BQzdDQSxLQUFLOEUsZUFBaUI5RSxLQUFLOEUsZUFBZUYsS0FBSzVFLE1BQy9DQSxLQUFLK0UsVUFBVyxFQUNoQi9FLEtBQUtnRixPQWxNVCxTQUFnQkMsRUFBUWxCLEdBQ3RCLElBQUssSUFBSTNDLEtBQU8yQyxFQUNkLEdBQW1CLE1BQWZrQixFQUFPN0QsR0FBYyxDQUN2QixJQUFJWCxFQUFRc0QsRUFBUzNDLEdBQ3JCNkQsRUFBTzdELEdBQU9YLEVBR2xCLE9BQU93RSxFQTJMU0MsQ0FBT3RCLEVBQVM1RCxLQUFLK0QsVUFDSixNQUEzQkgsRUFBUVUsa0JBQ1Z0RSxLQUFLZ0YsT0FBT1YsZ0JBQWtCYSxTQUFTQyxjQUFjeEIsRUFBUVUsa0JBRy9EdEUsS0FBS3FGLG1CQUFxQixJQUFJaEQsRUFDOUJyQyxLQUFLc0YsU0F6TFQsU0FBcUJ4RCxHQUNuQixJQUFJeUQsSUFBUzFCLFVBQVU5QyxRQUFVLFFBQXNCK0MsSUFBakJELFVBQVUsS0FBMkJBLFVBQVUsR0FDakYyQixJQUFTM0IsVUFBVTlDLFFBQVUsUUFBc0IrQyxJQUFqQkQsVUFBVSxLQUEyQkEsVUFBVSxHQUNqRjRCLEVBQVM1QixVQUFVOUMsUUFBVSxRQUFzQitDLElBQWpCRCxVQUFVLEdBQW1CLEtBQU9BLFVBQVUsR0FFaEY2QixPQUFjLEVBYWxCLE9BWjRCLE1BQXhCUCxTQUFTUSxhQUVYRCxFQUFjUCxTQUFTUSxZQUFZLGdCQUN2QkMsZ0JBQWdCOUQsRUFBT3lELEVBQVFDLEVBQVFDLEdBQ1osTUFBOUJOLFNBQVNVLG1CQUVsQkgsRUFBY1AsU0FBU1UscUJBQ1hDLFVBQVloRSxFQUV4QjRELEVBQVlLLFVBQVlqRSxFQUduQjRELEVBdUtXQyxDQUFZM0YsS0FBS2dGLE9BQU9oQixVQXlSMUMsT0F0UkF0RCxFQUFhWCxJQUNYcUIsSUFBSyxPQUNMWCxNQUFPLFdBQ0xULEtBQUtnRyxRQUFVMUQsT0FBTzZDLFNBQVNjLGdCQUMzQnpFLEVBQUsyRCxTQUFTZSxZQUFhLGNBQWUsYUFDNUNsRyxLQUFLMkUsUUFFTC9DLEVBQVN1RCxTQUFVLG1CQUFvQm5GLEtBQUsyRSxPQUU5QzNFLEtBQUttRyxlQUdQL0UsSUFBSyxRQUNMWCxNQUFPLFdBQ0wsSUFBSTJGLEVBQVFwRyxLQUtaLEdBSEFBLEtBQUtxRyxTQUFVLEVBQ2ZyRyxLQUFLc0csU0FBV0MsTUFBTUMsS0FBS3hHLEtBQUtnRyxRQUFRUyxpQkFBaUIsSUFBTXpHLEtBQUtnRixPQUFPaEIsV0FDM0VoRSxLQUFLMEcsSUFBTTFHLEtBQUtzRyxNQUFNQyxNQUFNLEdBQ3hCdkcsS0FBS3NHLE1BQU12RixPQUNiLEdBQUlmLEtBQUsyRyxXQUNQM0csS0FBSzRHLGtCQUVMLElBQUssSUFBSTlGLEVBQUksRUFBR0EsRUFBSWQsS0FBS3NHLE1BQU12RixPQUFRRCxJQUFLLENBQzFDLElBQUkrRixFQUFNN0csS0FBS3NHLE1BQU14RixHQUNyQmQsS0FBSzhHLFdBQVdELEdBQUssSUFJdEI3RyxLQUFLMkcsYUFDUi9FLEVBQVM1QixLQUFLZ0YsT0FBT1YsaUJBQW1CaEMsT0FBUSxTQUFVdEMsS0FBSzZFLGVBQy9EakQsRUFBU1UsT0FBUSxTQUFVdEMsS0FBSzZFLGVBQ2hDN0UsS0FBSytHLFNBQVdDLFlBQVloSCxLQUFLOEUsZUFBZ0IsS0FFL0M5RSxLQUFLZ0YsT0FBT1osT0FDSixJQUFJekIsRUFBaUIsU0FBVXNFLEdBQ3ZDLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJRCxFQUFRbEcsT0FBUW1HLElBRWxDLElBREEsSUFBSUMsRUFBU0YsRUFBUUMsR0FDWkUsRUFBSSxFQUFHQSxFQUFJRCxFQUFPRSxXQUFXdEcsT0FBUXFHLElBQUssQ0FDakQsSUFBSUUsRUFBT0gsRUFBT0UsV0FBV0QsR0FDN0JoQixFQUFNbUIsT0FBT0QsTUFLZkUsUUFBUXJDLFNBQVNzQyxNQUNuQkMsV0FBVyxFQUNYQyxTQUFTLE9BS2Z2RyxJQUFLLE9BQ0xYLE1BQU8sV0FDTFQsS0FBS3FHLFNBQVUsRUFDZm5FLEVBQVlsQyxLQUFLZ0YsT0FBT1YsaUJBQW1CaEMsT0FBUSxTQUFVdEMsS0FBSzZFLGVBQ2xFM0MsRUFBWUksT0FBUSxTQUFVdEMsS0FBSzZFLGVBQ2QsTUFBakI3RSxLQUFLK0csVUFDUGEsY0FBYzVILEtBQUsrRyxhQUl2QjNGLElBQUssT0FDTFgsTUFBTyxXQUNEa0MsRUFBaUJLLGNBQ25CaEQsS0FBS3VILE9BQU92SCxLQUFLZ0csWUFJckI1RSxJQUFLLFNBQ0xYLE1BQU8sU0FBZ0J1RixHQUlyQixRQUh1QixJQUFaQSxHQUF1QyxPQUFaQSxJQUNwQ0EsRUFBVWhHLEtBQUtnRyxTQUVRLElBQXJCQSxFQUFRNkIsU0FLWixJQURBLElBQUlDLEdBREo5QixFQUFVQSxFQUFRK0IsWUFBYy9CLEdBQ1RTLGlCQUFpQixJQUFNekcsS0FBS2dGLE9BQU9oQixVQUNqRGxELEVBQUksRUFBR0EsRUFBSWdILEVBQVMvRyxPQUFRRCxJQUFLLENBQ3hDLElBQUkrRixFQUFNaUIsRUFBU2hILEdBQ2RVLEVBQUtxRixFQUFLN0csS0FBSzBHLE9BQ2xCMUcsS0FBS3NHLE1BQU01RCxLQUFLbUUsR0FDaEI3RyxLQUFLMEcsSUFBSWhFLEtBQUttRSxHQUNWN0csS0FBS3FHLFNBQVdyRyxLQUFLMkcsV0FDdkIzRyxLQUFLNEcsYUFFTDVHLEtBQUs4RyxXQUFXRCxHQUFLLEdBRXZCN0csS0FBSytFLFVBQVcsT0FLdEIzRCxJQUFLLE9BQ0xYLE1BQU8sU0FBY29HLEdBdFF6QixJQUFtQmhGLEVBQU1DLEVBcVJuQixPQWRBOUIsS0FBSzhHLFdBQVdELEdBQ2hCQSxFQUFJbUIsVUFBWW5CLEVBQUltQixVQUFZLElBQU1oSSxLQUFLZ0YsT0FBT2YsYUFDdEIsTUFBeEJqRSxLQUFLZ0YsT0FBT1gsVUFDZHJFLEtBQUtnRixPQUFPWCxTQUFTd0MsR0ExUVZoRixFQTRRSGdGLEVBNVFTL0UsRUE0UUo5QixLQUFLc0YsU0EzUUUsTUFBdEJ6RCxFQUFLb0csY0FFUHBHLEVBQUtvRyxjQUFjbkcsR0FDVkEsS0FBa0IsTUFBUkQsR0FDbkJBLEVBQUtDLEtBQ0ksS0FBT0EsS0FBa0IsTUFBUkQsSUFDMUJBLEVBQUssS0FBT0MsS0F1UU45QixLQUFLZ0YsT0FBT1QsaUJBQ2QzQyxFQUFTaUYsRUFBSyxlQUFnQjdHLEtBQUt1RSxnQkFDbkMzQyxFQUFTaUYsRUFBSyxnQkFBaUI3RyxLQUFLdUUsZ0JBQ3BDM0MsRUFBU2lGLEVBQUsscUJBQXNCN0csS0FBS3VFLGdCQUN6QzNDLEVBQVNpRixFQUFLLGlCQUFrQjdHLEtBQUt1RSxpQkFHaENzQyxLQUdUekYsSUFBSyxhQUNMWCxNQUFPLFNBQW9Cb0csRUFBS3FCLEdBQzlCLElBQUlDLEVBQVNuSSxLQUVUb0ksRUFBV3ZCLEVBQUl3QixhQUFhLHFCQUM1QkMsRUFBUXpCLEVBQUl3QixhQUFhLGtCQUN6QkUsRUFBWTFCLEVBQUl3QixhQUFhLHNCQUVqQyxPQUFPckksS0FBS3dFLFFBQVEsV0FDbEIsT0FBTzJELEVBQU9LLFlBQVkzQixFQUFLcUIsRUFBUUUsRUFBVUUsRUFBT0MsUUFJNURuSCxJQUFLLGFBQ0xYLE1BQU8sV0FDTCxJQUFLLElBQUlLLEVBQUksRUFBR0EsRUFBSWQsS0FBS3NHLE1BQU12RixPQUFRRCxJQUFLLENBQ2hDZCxLQUFLc0csTUFBTXhGLEdBQ2pCMkgsTUFBTUMsV0FBYSxjQUszQnRILElBQUssaUJBQ0xYLE1BQU8sU0FBd0JxQixHQUM3QixHQUFJQSxFQUFNNkcsS0FBS0MsY0FBY2pILFFBQVEsaUJBQW1CLEVBQUcsQ0FDekQsSUFBSWYsRUFBU2tCLEVBQU1sQixRQUFVa0IsRUFBTStHLFdBQ25DakksRUFBT29ILFVBQVlwSCxFQUFPb0gsVUFBVXpFLFFBQVF2RCxLQUFLZ0YsT0FBT2YsYUFBYyxJQUFJNkUsV0FJOUUxSCxJQUFLLGNBQ0xYLE1BQU8sU0FBcUJvRyxFQUFLcUIsRUFBUUUsRUFBVUUsRUFBT0MsR0FpQnhELE9BaEJJTCxHQUNGbEksS0FBSytJLG1CQUFtQmxDLEdBRTFCQSxFQUFJNEIsTUFBTUMsV0FBYVIsRUFBUyxTQUFXLFVBRXZDRSxHQUNGcEksS0FBS2dKLFVBQVVuQyxFQUFJNEIsT0FBU1Esa0JBQW1CYixJQUU3Q0UsR0FDRnRJLEtBQUtnSixVQUFVbkMsRUFBSTRCLE9BQVNTLGVBQWdCWixJQUUxQ0MsR0FDRnZJLEtBQUtnSixVQUFVbkMsRUFBSTRCLE9BQVNVLHdCQUF5QlosSUFFdkR2SSxLQUFLZ0osVUFBVW5DLEVBQUk0QixPQUFTVyxjQUFlbEIsRUFBUyxPQUFTbEksS0FBS3FKLG9CQUFvQnhDLEtBRS9FQSxLQUdUekYsSUFBSyxZQUNMWCxNQUFPLFNBQW1Cb0IsRUFBTXlILEdBQzlCLElBQUssSUFBSUMsS0FBUUQsRUFDZixHQUFJQSxFQUFXRSxlQUFlRCxHQUFPLENBQ25DLElBQUk5SSxFQUFRNkksRUFBV0MsR0FDdkIxSCxFQUFLLEdBQUswSCxHQUFROUksRUFDbEIsSUFBSyxJQUFJSyxFQUFJLEVBQUdBLEVBQUlkLEtBQUswRSxRQUFRM0QsT0FBUUQsSUFBSyxDQUU1Q2UsRUFBSyxHQURRN0IsS0FBSzBFLFFBQVE1RCxHQUNQeUksRUFBS0UsT0FBTyxHQUFHL0YsY0FBZ0I2RixFQUFLRyxPQUFPLElBQU1qSixPQU01RVcsSUFBSyxZQUNMWCxNQUFPLFNBQW1Cb0IsRUFBTThILEdBRzlCLElBRkEsSUFBSWxCLEVBQVF4RixFQUFpQnBCLEdBQ3pCK0gsRUFBU25CLEVBQU1vQixvQkFBb0JGLEdBQzlCN0ksRUFBSSxFQUFHQSxFQUFJZCxLQUFLMEUsUUFBUTNELE9BQVFELElBQUssQ0FDNUMsSUFBSWdKLEVBQVM5SixLQUFLMEUsUUFBUTVELEdBQzFCOEksRUFBU0EsR0FBVW5CLEVBQU1vQixvQkFBb0IsSUFBTUMsRUFBUyxJQUFNSCxHQUVwRSxPQUFPQyxLQUdUeEksSUFBSyxnQkFDTFgsTUFBTyxTQUF1Qm9HLEdBQzVCLElBQUlrRCxPQUFRLEVBQ1osSUFDRUEsRUFBUS9KLEtBQUtnSyxVQUFVbkQsRUFBSyxrQkFBa0JvRCxRQUM5QyxNQUFPQyxHQUVQSCxFQUFROUcsRUFBaUI0RCxHQUFLekQsaUJBQWlCLGtCQUdqRCxNQUFjLFNBQVYyRyxFQUNLLEdBR0ZBLEtBR1QzSSxJQUFLLHFCQUNMWCxNQUFPLFNBQTRCb0csR0FHakMsT0FBTzdHLEtBQUtxRixtQkFBbUI4RSxJQUFJdEQsRUFBSzdHLEtBQUtvSixjQUFjdkMsT0FHN0R6RixJQUFLLHNCQUNMWCxNQUFPLFNBQTZCb0csR0FDbEMsT0FBTzdHLEtBQUtxRixtQkFBbUIrRSxJQUFJdkQsTUFHckN6RixJQUFLLGdCQUNMWCxNQUFPLFdBQ0xULEtBQUsrRSxVQUFXLEtBR2xCM0QsSUFBSyxpQkFDTFgsTUFBTyxXQUNMLEdBQUlULEtBQUsrRSxTQUFVLENBQ2pCL0UsS0FBSytFLFVBQVcsRUFFaEIsSUFEQSxJQUFJc0YsS0FDS3ZKLEVBQUksRUFBR0EsRUFBSWQsS0FBS3NHLE1BQU12RixPQUFRRCxJQUFLLENBQzFDLElBQUkrRixFQUFNN0csS0FBS3NHLE1BQU14RixHQUNyQixHQUFJK0YsRUFBSyxDQUNQLEdBQUk3RyxLQUFLc0ssVUFBVXpELEdBQU0sQ0FDdkI3RyxLQUFLdUssS0FBSzFELEdBQ1YsU0FFRndELEVBQVEzSCxLQUFLbUUsSUFHakI3RyxLQUFLc0csTUFBUStELEVBQ1JySyxLQUFLc0csTUFBTXZGLFFBQVdmLEtBQUtnRixPQUFPWixNQUNyQ3BFLEtBQUt3SyxXQUtYcEosSUFBSyxZQUNMWCxNQUFPLFNBQW1CdUYsR0FJeEIsVUFBNkJsQyxJQUF0QmtDLEVBQVF5RSxXQUNiekUsRUFBVUEsRUFBUStCLFdBR3BCLElBREEsSUFBSTJDLEVBQU0xRSxFQUFReUUsVUFDWHpFLEVBQVEyRSxjQUViRCxJQURBMUUsRUFBVUEsRUFBUTJFLGNBQ0hGLFVBRWpCLE9BQU9DLEtBR1R0SixJQUFLLFlBQ0xYLE1BQU8sU0FBbUJvRyxHQUN4QixJQUFJM0MsRUFBUzJDLEVBQUl3QixhQUFhLG9CQUFzQnJJLEtBQUtnRixPQUFPZCxPQUM1RDBHLEVBQVU1SyxLQUFLZ0YsT0FBT1YsaUJBQW1CdEUsS0FBS2dGLE9BQU9WLGdCQUFnQnVHLFdBQWF2SSxPQUFPd0ksWUFDekZDLEVBQWFILEVBQVVJLEtBQUtDLElBQUlqTCxLQUFLZ0csUUFBUWtGLGFBMVlqRCxnQkFBaUI1SSxPQUNaQSxPQUFPNkksWUFHVGhHLFNBQVNjLGdCQUFnQmlGLGNBc1l1RGhILEVBQy9Fd0csRUFBTTFLLEtBQUt5SyxVQUFVNUQsR0FDckJ1RSxFQUFTVixFQUFNN0QsRUFBSXFFLGFBRXZCLE9BQU9SLEdBQU9LLEdBQWNLLEdBQVVSLEtBR3hDeEosSUFBSyxXQUNMWCxNQUFPLFdBQ0wsT0FBUVQsS0FBS2dGLE9BQU9iLFNBbmRSa0gsRUFtZDJCQyxVQUFVQyxVQWxkN0MsaUVBQWlFakksS0FBSytILElBRGhGLElBQWtCQSxNQXVkVHRMLEVBbFVDLEdBcVVWSCxFQUFRNEwsUUFBVXpMLEVBQ2xCRixFQUFPRCxRQUFVQSxFQUFpQiIsImZpbGUiOiJ3b3cuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoWydtb2R1bGUnLCAnZXhwb3J0cyddLCBmYWN0b3J5KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGZhY3RvcnkobW9kdWxlLCBleHBvcnRzKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgbW9kID0ge1xuICAgICAgZXhwb3J0czoge31cbiAgICB9O1xuICAgIGZhY3RvcnkobW9kLCBtb2QuZXhwb3J0cyk7XG4gICAgZ2xvYmFsLldPVyA9IG1vZC5leHBvcnRzO1xuICB9XG59KSh0aGlzLCBmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxuICB9KTtcblxuICB2YXIgX2NsYXNzLCBfdGVtcDtcblxuICBmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gICAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICB9XG5cbiAgdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTtcbiAgICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgICAgIGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xuICAgICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcbiAgICAgIGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO1xuICAgICAgcmV0dXJuIENvbnN0cnVjdG9yO1xuICAgIH07XG4gIH0oKTtcblxuICBmdW5jdGlvbiBpc0luKG5lZWRsZSwgaGF5c3RhY2spIHtcbiAgICByZXR1cm4gaGF5c3RhY2suaW5kZXhPZihuZWVkbGUpID49IDA7XG4gIH1cblxuICBmdW5jdGlvbiBleHRlbmQoY3VzdG9tLCBkZWZhdWx0cykge1xuICAgIGZvciAodmFyIGtleSBpbiBkZWZhdWx0cykge1xuICAgICAgaWYgKGN1c3RvbVtrZXldID09IG51bGwpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gZGVmYXVsdHNba2V5XTtcbiAgICAgICAgY3VzdG9tW2tleV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGN1c3RvbTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzTW9iaWxlKGFnZW50KSB7XG4gICAgcmV0dXJuICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QoYWdlbnQpXG4gICAgKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZUV2ZW50KGV2ZW50KSB7XG4gICAgdmFyIGJ1YmJsZSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzFdO1xuICAgIHZhciBjYW5jZWwgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1syXTtcbiAgICB2YXIgZGV0YWlsID0gYXJndW1lbnRzLmxlbmd0aCA8PSAzIHx8IGFyZ3VtZW50c1szXSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGFyZ3VtZW50c1szXTtcblxuICAgIHZhciBjdXN0b21FdmVudCA9IHZvaWQgMDtcbiAgICBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnQgIT0gbnVsbCkge1xuICAgICAgLy8gVzNDIERPTVxuICAgICAgY3VzdG9tRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICAgIGN1c3RvbUV2ZW50LmluaXRDdXN0b21FdmVudChldmVudCwgYnViYmxlLCBjYW5jZWwsIGRldGFpbCk7XG4gICAgfSBlbHNlIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCAhPSBudWxsKSB7XG4gICAgICAvLyBJRSBET00gPCA5XG4gICAgICBjdXN0b21FdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XG4gICAgICBjdXN0b21FdmVudC5ldmVudFR5cGUgPSBldmVudDtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VzdG9tRXZlbnQuZXZlbnROYW1lID0gZXZlbnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGN1c3RvbUV2ZW50O1xuICB9XG5cbiAgZnVuY3Rpb24gZW1pdEV2ZW50KGVsZW0sIGV2ZW50KSB7XG4gICAgaWYgKGVsZW0uZGlzcGF0Y2hFdmVudCAhPSBudWxsKSB7XG4gICAgICAvLyBXM0MgRE9NXG4gICAgICBlbGVtLmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQgaW4gKGVsZW0gIT0gbnVsbCkpIHtcbiAgICAgIGVsZW1bZXZlbnRdKCk7XG4gICAgfSBlbHNlIGlmICgnb24nICsgZXZlbnQgaW4gKGVsZW0gIT0gbnVsbCkpIHtcbiAgICAgIGVsZW1bJ29uJyArIGV2ZW50XSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZEV2ZW50KGVsZW0sIGV2ZW50LCBmbikge1xuICAgIGlmIChlbGVtLmFkZEV2ZW50TGlzdGVuZXIgIT0gbnVsbCkge1xuICAgICAgLy8gVzNDIERPTVxuICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBmbiwgZmFsc2UpO1xuICAgIH0gZWxzZSBpZiAoZWxlbS5hdHRhY2hFdmVudCAhPSBudWxsKSB7XG4gICAgICAvLyBJRSBET01cbiAgICAgIGVsZW0uYXR0YWNoRXZlbnQoJ29uJyArIGV2ZW50LCBmbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGZhbGxiYWNrXG4gICAgICBlbGVtW2V2ZW50XSA9IGZuO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZUV2ZW50KGVsZW0sIGV2ZW50LCBmbikge1xuICAgIGlmIChlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIgIT0gbnVsbCkge1xuICAgICAgLy8gVzNDIERPTVxuICAgICAgZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBmbiwgZmFsc2UpO1xuICAgIH0gZWxzZSBpZiAoZWxlbS5kZXRhY2hFdmVudCAhPSBudWxsKSB7XG4gICAgICAvLyBJRSBET01cbiAgICAgIGVsZW0uZGV0YWNoRXZlbnQoJ29uJyArIGV2ZW50LCBmbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGZhbGxiYWNrXG4gICAgICBkZWxldGUgZWxlbVtldmVudF07XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0SW5uZXJIZWlnaHQoKSB7XG4gICAgaWYgKCdpbm5lckhlaWdodCcgaW4gd2luZG93KSB7XG4gICAgICByZXR1cm4gd2luZG93LmlubmVySGVpZ2h0O1xuICAgIH1cblxuICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICB9XG5cbiAgLy8gTWluaW1hbGlzdGljIFdlYWtNYXAgc2hpbSwganVzdCBpbiBjYXNlLlxuICB2YXIgV2Vha01hcCA9IHdpbmRvdy5XZWFrTWFwIHx8IHdpbmRvdy5Nb3pXZWFrTWFwIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBXZWFrTWFwKCkge1xuICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFdlYWtNYXApO1xuXG4gICAgICB0aGlzLmtleXMgPSBbXTtcbiAgICAgIHRoaXMudmFsdWVzID0gW107XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFdlYWtNYXAsIFt7XG4gICAgICBrZXk6ICdnZXQnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldChrZXkpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMua2V5c1tpXTtcbiAgICAgICAgICBpZiAoaXRlbSA9PT0ga2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbaV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnc2V0JyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMua2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5rZXlzW2ldO1xuICAgICAgICAgIGlmIChpdGVtID09PSBrZXkpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWVzW2ldID0gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5rZXlzLnB1c2goa2V5KTtcbiAgICAgICAgdGhpcy52YWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBXZWFrTWFwO1xuICB9KCk7XG5cbiAgLy8gRHVtbXkgTXV0YXRpb25PYnNlcnZlciwgdG8gYXZvaWQgcmFpc2luZyBleGNlcHRpb25zLlxuICB2YXIgTXV0YXRpb25PYnNlcnZlciA9IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5XZWJraXRNdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5Nb3pNdXRhdGlvbk9ic2VydmVyIHx8IChfdGVtcCA9IF9jbGFzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNdXRhdGlvbk9ic2VydmVyKCkge1xuICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE11dGF0aW9uT2JzZXJ2ZXIpO1xuXG4gICAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUgIT09IG51bGwpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdNdXRhdGlvbk9ic2VydmVyIGlzIG5vdCBzdXBwb3J0ZWQgYnkgeW91ciBicm93c2VyLicpO1xuICAgICAgICBjb25zb2xlLndhcm4oJ1dPVy5qcyBjYW5ub3QgZGV0ZWN0IGRvbSBtdXRhdGlvbnMsIHBsZWFzZSBjYWxsIC5zeW5jKCkgYWZ0ZXIgbG9hZGluZyBuZXcgY29udGVudC4nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTXV0YXRpb25PYnNlcnZlciwgW3tcbiAgICAgIGtleTogJ29ic2VydmUnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9ic2VydmUoKSB7fVxuICAgIH1dKTtcblxuICAgIHJldHVybiBNdXRhdGlvbk9ic2VydmVyO1xuICB9KCksIF9jbGFzcy5ub3RTdXBwb3J0ZWQgPSB0cnVlLCBfdGVtcCk7XG5cbiAgLy8gZ2V0Q29tcHV0ZWRTdHlsZSBzaGltLCBmcm9tIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIxNzk3Mjk0XG4gIHZhciBnZXRDb21wdXRlZFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUgfHwgZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZShlbCkge1xuICAgIHZhciBnZXRDb21wdXRlZFN0eWxlUlggPSAvKFxcLShbYS16XSl7MX0pL2c7XG4gICAgcmV0dXJuIHtcbiAgICAgIGdldFByb3BlcnR5VmFsdWU6IGZ1bmN0aW9uIGdldFByb3BlcnR5VmFsdWUocHJvcCkge1xuICAgICAgICBpZiAocHJvcCA9PT0gJ2Zsb2F0Jykge1xuICAgICAgICAgIHByb3AgPSAnc3R5bGVGbG9hdCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdldENvbXB1dGVkU3R5bGVSWC50ZXN0KHByb3ApKSB7XG4gICAgICAgICAgcHJvcC5yZXBsYWNlKGdldENvbXB1dGVkU3R5bGVSWCwgZnVuY3Rpb24gKF8sIF9jaGFyKSB7XG4gICAgICAgICAgICByZXR1cm4gX2NoYXIudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3VycmVudFN0eWxlID0gZWwuY3VycmVudFN0eWxlO1xuXG4gICAgICAgIHJldHVybiAoY3VycmVudFN0eWxlICE9IG51bGwgPyBjdXJyZW50U3R5bGVbcHJvcF0gOiB2b2lkIDApIHx8IG51bGw7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICB2YXIgV09XID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFdPVygpIHtcbiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMF07XG5cbiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXT1cpO1xuXG4gICAgICB0aGlzLmRlZmF1bHRzID0ge1xuICAgICAgICBib3hDbGFzczogJ3dvdycsXG4gICAgICAgIGFuaW1hdGVDbGFzczogJ2FuaW1hdGVkJyxcbiAgICAgICAgb2Zmc2V0OiAwLFxuICAgICAgICBtb2JpbGU6IHRydWUsXG4gICAgICAgIGxpdmU6IHRydWUsXG4gICAgICAgIGNhbGxiYWNrOiBudWxsLFxuICAgICAgICBzY3JvbGxDb250YWluZXI6IG51bGwsXG4gICAgICAgIHJlc2V0QW5pbWF0aW9uOiB0cnVlXG4gICAgICB9O1xuXG4gICAgICB0aGlzLmFuaW1hdGUgPSBmdW5jdGlvbiBhbmltYXRlRmFjdG9yeSgpIHtcbiAgICAgICAgaWYgKCdyZXF1ZXN0QW5pbWF0aW9uRnJhbWUnIGluIHdpbmRvdykge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNhbGxiYWNrKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2soKTtcbiAgICAgICAgfTtcbiAgICAgIH0oKTtcblxuICAgICAgdGhpcy52ZW5kb3JzID0gWydtb3onLCAnd2Via2l0J107XG5cbiAgICAgIHRoaXMuc3RhcnQgPSB0aGlzLnN0YXJ0LmJpbmQodGhpcyk7XG4gICAgICB0aGlzLnJlc2V0QW5pbWF0aW9uID0gdGhpcy5yZXNldEFuaW1hdGlvbi5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy5zY3JvbGxIYW5kbGVyID0gdGhpcy5zY3JvbGxIYW5kbGVyLmJpbmQodGhpcyk7XG4gICAgICB0aGlzLnNjcm9sbENhbGxiYWNrID0gdGhpcy5zY3JvbGxDYWxsYmFjay5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy5zY3JvbGxlZCA9IHRydWU7XG4gICAgICB0aGlzLmNvbmZpZyA9IGV4dGVuZChvcHRpb25zLCB0aGlzLmRlZmF1bHRzKTtcbiAgICAgIGlmIChvcHRpb25zLnNjcm9sbENvbnRhaW5lciAhPSBudWxsKSB7XG4gICAgICAgIHRoaXMuY29uZmlnLnNjcm9sbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9ucy5zY3JvbGxDb250YWluZXIpO1xuICAgICAgfVxuICAgICAgLy8gTWFwIG9mIGVsZW1lbnRzIHRvIGFuaW1hdGlvbiBuYW1lczpcbiAgICAgIHRoaXMuYW5pbWF0aW9uTmFtZUNhY2hlID0gbmV3IFdlYWtNYXAoKTtcbiAgICAgIHRoaXMud293RXZlbnQgPSBjcmVhdGVFdmVudCh0aGlzLmNvbmZpZy5ib3hDbGFzcyk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFdPVywgW3tcbiAgICAgIGtleTogJ2luaXQnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgIGlmIChpc0luKGRvY3VtZW50LnJlYWR5U3RhdGUsIFsnaW50ZXJhY3RpdmUnLCAnY29tcGxldGUnXSkpIHtcbiAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWRkRXZlbnQoZG9jdW1lbnQsICdET01Db250ZW50TG9hZGVkJywgdGhpcy5zdGFydCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maW5pc2hlZCA9IFtdO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ3N0YXJ0JyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICB0aGlzLnN0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5ib3hlcyA9IFtdLnNsaWNlLmNhbGwodGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgdGhpcy5jb25maWcuYm94Q2xhc3MpKTtcbiAgICAgICAgdGhpcy5hbGwgPSB0aGlzLmJveGVzLnNsaWNlKDApO1xuICAgICAgICBpZiAodGhpcy5ib3hlcy5sZW5ndGgpIHtcbiAgICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCgpKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0U3R5bGUoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmJveGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgIHZhciBib3ggPSB0aGlzLmJveGVzW2ldO1xuICAgICAgICAgICAgICB0aGlzLmFwcGx5U3R5bGUoYm94LCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKCkpIHtcbiAgICAgICAgICBhZGRFdmVudCh0aGlzLmNvbmZpZy5zY3JvbGxDb250YWluZXIgfHwgd2luZG93LCAnc2Nyb2xsJywgdGhpcy5zY3JvbGxIYW5kbGVyKTtcbiAgICAgICAgICBhZGRFdmVudCh3aW5kb3csICdyZXNpemUnLCB0aGlzLnNjcm9sbEhhbmRsZXIpO1xuICAgICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCh0aGlzLnNjcm9sbENhbGxiYWNrLCA1MCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmxpdmUpIHtcbiAgICAgICAgICB2YXIgbXV0ID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKHJlY29yZHMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcmVjb3Jkcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICB2YXIgcmVjb3JkID0gcmVjb3Jkc1tqXTtcbiAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCByZWNvcmQuYWRkZWROb2Rlcy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgIHZhciBub2RlID0gcmVjb3JkLmFkZGVkTm9kZXNba107XG4gICAgICAgICAgICAgICAgX3RoaXMuZG9TeW5jKG5vZGUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIG11dC5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ3N0b3AnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuc3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuY29uZmlnLnNjcm9sbENvbnRhaW5lciB8fCB3aW5kb3csICdzY3JvbGwnLCB0aGlzLnNjcm9sbEhhbmRsZXIpO1xuICAgICAgICByZW1vdmVFdmVudCh3aW5kb3csICdyZXNpemUnLCB0aGlzLnNjcm9sbEhhbmRsZXIpO1xuICAgICAgICBpZiAodGhpcy5pbnRlcnZhbCAhPSBudWxsKSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ3N5bmMnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN5bmMoKSB7XG4gICAgICAgIGlmIChNdXRhdGlvbk9ic2VydmVyLm5vdFN1cHBvcnRlZCkge1xuICAgICAgICAgIHRoaXMuZG9TeW5jKHRoaXMuZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6ICdkb1N5bmMnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRvU3luYyhlbGVtZW50KSB7XG4gICAgICAgIGlmICh0eXBlb2YgZWxlbWVudCA9PT0gJ3VuZGVmaW5lZCcgfHwgZWxlbWVudCA9PT0gbnVsbCkge1xuICAgICAgICAgIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVsZW1lbnQubm9kZVR5cGUgIT09IDEpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50Tm9kZSB8fCBlbGVtZW50O1xuICAgICAgICB2YXIgaXRlcmFibGUgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgdGhpcy5jb25maWcuYm94Q2xhc3MpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZXJhYmxlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIGJveCA9IGl0ZXJhYmxlW2ldO1xuICAgICAgICAgIGlmICghaXNJbihib3gsIHRoaXMuYWxsKSkge1xuICAgICAgICAgICAgdGhpcy5ib3hlcy5wdXNoKGJveCk7XG4gICAgICAgICAgICB0aGlzLmFsbC5wdXNoKGJveCk7XG4gICAgICAgICAgICBpZiAodGhpcy5zdG9wcGVkIHx8IHRoaXMuZGlzYWJsZWQoKSkge1xuICAgICAgICAgICAgICB0aGlzLnJlc2V0U3R5bGUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuYXBwbHlTdHlsZShib3gsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zY3JvbGxlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnc2hvdycsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdyhib3gpIHtcbiAgICAgICAgdGhpcy5hcHBseVN0eWxlKGJveCk7XG4gICAgICAgIGJveC5jbGFzc05hbWUgPSBib3guY2xhc3NOYW1lICsgJyAnICsgdGhpcy5jb25maWcuYW5pbWF0ZUNsYXNzO1xuICAgICAgICBpZiAodGhpcy5jb25maWcuY2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuY29uZmlnLmNhbGxiYWNrKGJveCk7XG4gICAgICAgIH1cbiAgICAgICAgZW1pdEV2ZW50KGJveCwgdGhpcy53b3dFdmVudCk7XG5cbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLnJlc2V0QW5pbWF0aW9uKSB7XG4gICAgICAgICAgYWRkRXZlbnQoYm94LCAnYW5pbWF0aW9uZW5kJywgdGhpcy5yZXNldEFuaW1hdGlvbik7XG4gICAgICAgICAgYWRkRXZlbnQoYm94LCAnb2FuaW1hdGlvbmVuZCcsIHRoaXMucmVzZXRBbmltYXRpb24pO1xuICAgICAgICAgIGFkZEV2ZW50KGJveCwgJ3dlYmtpdEFuaW1hdGlvbkVuZCcsIHRoaXMucmVzZXRBbmltYXRpb24pO1xuICAgICAgICAgIGFkZEV2ZW50KGJveCwgJ01TQW5pbWF0aW9uRW5kJywgdGhpcy5yZXNldEFuaW1hdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYm94O1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2FwcGx5U3R5bGUnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5U3R5bGUoYm94LCBoaWRkZW4pIHtcbiAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgdmFyIGR1cmF0aW9uID0gYm94LmdldEF0dHJpYnV0ZSgnZGF0YS13b3ctZHVyYXRpb24nKTtcbiAgICAgICAgdmFyIGRlbGF5ID0gYm94LmdldEF0dHJpYnV0ZSgnZGF0YS13b3ctZGVsYXknKTtcbiAgICAgICAgdmFyIGl0ZXJhdGlvbiA9IGJveC5nZXRBdHRyaWJ1dGUoJ2RhdGEtd293LWl0ZXJhdGlvbicpO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmFuaW1hdGUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBfdGhpczIuY3VzdG9tU3R5bGUoYm94LCBoaWRkZW4sIGR1cmF0aW9uLCBkZWxheSwgaXRlcmF0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAncmVzZXRTdHlsZScsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXRTdHlsZSgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmJveGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIGJveCA9IHRoaXMuYm94ZXNbaV07XG4gICAgICAgICAgYm94LnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6ICdyZXNldEFuaW1hdGlvbicsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXRBbmltYXRpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnR5cGUudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdhbmltYXRpb25lbmQnKSA+PSAwKSB7XG4gICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldCB8fCBldmVudC5zcmNFbGVtZW50O1xuICAgICAgICAgIHRhcmdldC5jbGFzc05hbWUgPSB0YXJnZXQuY2xhc3NOYW1lLnJlcGxhY2UodGhpcy5jb25maWcuYW5pbWF0ZUNsYXNzLCAnJykudHJpbSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnY3VzdG9tU3R5bGUnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGN1c3RvbVN0eWxlKGJveCwgaGlkZGVuLCBkdXJhdGlvbiwgZGVsYXksIGl0ZXJhdGlvbikge1xuICAgICAgICBpZiAoaGlkZGVuKSB7XG4gICAgICAgICAgdGhpcy5jYWNoZUFuaW1hdGlvbk5hbWUoYm94KTtcbiAgICAgICAgfVxuICAgICAgICBib3guc3R5bGUudmlzaWJpbGl0eSA9IGhpZGRlbiA/ICdoaWRkZW4nIDogJ3Zpc2libGUnO1xuXG4gICAgICAgIGlmIChkdXJhdGlvbikge1xuICAgICAgICAgIHRoaXMudmVuZG9yU2V0KGJveC5zdHlsZSwgeyBhbmltYXRpb25EdXJhdGlvbjogZHVyYXRpb24gfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlbGF5KSB7XG4gICAgICAgICAgdGhpcy52ZW5kb3JTZXQoYm94LnN0eWxlLCB7IGFuaW1hdGlvbkRlbGF5OiBkZWxheSB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlcmF0aW9uKSB7XG4gICAgICAgICAgdGhpcy52ZW5kb3JTZXQoYm94LnN0eWxlLCB7IGFuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiBpdGVyYXRpb24gfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52ZW5kb3JTZXQoYm94LnN0eWxlLCB7IGFuaW1hdGlvbk5hbWU6IGhpZGRlbiA/ICdub25lJyA6IHRoaXMuY2FjaGVkQW5pbWF0aW9uTmFtZShib3gpIH0pO1xuXG4gICAgICAgIHJldHVybiBib3g7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAndmVuZG9yU2V0JyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiB2ZW5kb3JTZXQoZWxlbSwgcHJvcGVydGllcykge1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIHByb3BlcnRpZXMpIHtcbiAgICAgICAgICBpZiAocHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gcHJvcGVydGllc1tuYW1lXTtcbiAgICAgICAgICAgIGVsZW1bJycgKyBuYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnZlbmRvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgdmFyIHZlbmRvciA9IHRoaXMudmVuZG9yc1tpXTtcbiAgICAgICAgICAgICAgZWxlbVsnJyArIHZlbmRvciArIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnN1YnN0cigxKV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6ICd2ZW5kb3JDU1MnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZlbmRvckNTUyhlbGVtLCBwcm9wZXJ0eSkge1xuICAgICAgICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW0pO1xuICAgICAgICB2YXIgcmVzdWx0ID0gc3R5bGUuZ2V0UHJvcGVydHlDU1NWYWx1ZShwcm9wZXJ0eSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy52ZW5kb3JzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIHZlbmRvciA9IHRoaXMudmVuZG9yc1tpXTtcbiAgICAgICAgICByZXN1bHQgPSByZXN1bHQgfHwgc3R5bGUuZ2V0UHJvcGVydHlDU1NWYWx1ZSgnLScgKyB2ZW5kb3IgKyAnLScgKyBwcm9wZXJ0eSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6ICdhbmltYXRpb25OYW1lJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBhbmltYXRpb25OYW1lKGJveCkge1xuICAgICAgICB2YXIgYU5hbWUgPSB2b2lkIDA7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYU5hbWUgPSB0aGlzLnZlbmRvckNTUyhib3gsICdhbmltYXRpb24tbmFtZScpLmNzc1RleHQ7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgLy8gT3BlcmEsIGZhbGwgYmFjayB0byBwbGFpbiBwcm9wZXJ0eSB2YWx1ZVxuICAgICAgICAgIGFOYW1lID0gZ2V0Q29tcHV0ZWRTdHlsZShib3gpLmdldFByb3BlcnR5VmFsdWUoJ2FuaW1hdGlvbi1uYW1lJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYU5hbWUgPT09ICdub25lJykge1xuICAgICAgICAgIHJldHVybiAnJzsgLy8gU1ZHL0ZpcmVmb3gsIHVuYWJsZSB0byBnZXQgYW5pbWF0aW9uIG5hbWU/XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYU5hbWU7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnY2FjaGVBbmltYXRpb25OYW1lJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjYWNoZUFuaW1hdGlvbk5hbWUoYm94KSB7XG4gICAgICAgIC8vIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTkyMTgzNFxuICAgICAgICAvLyBib3guZGF0YXNldCBpcyBub3Qgc3VwcG9ydGVkIGZvciBTVkcgZWxlbWVudHMgaW4gRmlyZWZveFxuICAgICAgICByZXR1cm4gdGhpcy5hbmltYXRpb25OYW1lQ2FjaGUuc2V0KGJveCwgdGhpcy5hbmltYXRpb25OYW1lKGJveCkpO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2NhY2hlZEFuaW1hdGlvbk5hbWUnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNhY2hlZEFuaW1hdGlvbk5hbWUoYm94KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFuaW1hdGlvbk5hbWVDYWNoZS5nZXQoYm94KTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6ICdzY3JvbGxIYW5kbGVyJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzY3JvbGxIYW5kbGVyKCkge1xuICAgICAgICB0aGlzLnNjcm9sbGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6ICdzY3JvbGxDYWxsYmFjaycsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gc2Nyb2xsQ2FsbGJhY2soKSB7XG4gICAgICAgIGlmICh0aGlzLnNjcm9sbGVkKSB7XG4gICAgICAgICAgdGhpcy5zY3JvbGxlZCA9IGZhbHNlO1xuICAgICAgICAgIHZhciByZXN1bHRzID0gW107XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmJveGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYm94ID0gdGhpcy5ib3hlc1tpXTtcbiAgICAgICAgICAgIGlmIChib3gpIHtcbiAgICAgICAgICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlKGJveCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3coYm94KTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXN1bHRzLnB1c2goYm94KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5ib3hlcyA9IHJlc3VsdHM7XG4gICAgICAgICAgaWYgKCF0aGlzLmJveGVzLmxlbmd0aCAmJiAhdGhpcy5jb25maWcubGl2ZSkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnb2Zmc2V0VG9wJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBvZmZzZXRUb3AoZWxlbWVudCkge1xuICAgICAgICAvLyBTVkcgZWxlbWVudHMgZG9uJ3QgaGF2ZSBhbiBvZmZzZXRUb3AgaW4gRmlyZWZveC5cbiAgICAgICAgLy8gVGhpcyB3aWxsIHVzZSB0aGVpciBuZWFyZXN0IHBhcmVudCB0aGF0IGhhcyBhbiBvZmZzZXRUb3AuXG4gICAgICAgIC8vIEFsc28sIHVzaW5nICgnb2Zmc2V0VG9wJyBvZiBlbGVtZW50KSBjYXVzZXMgYW4gZXhjZXB0aW9uIGluIEZpcmVmb3guXG4gICAgICAgIHdoaWxlIChlbGVtZW50Lm9mZnNldFRvcCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdG9wID0gZWxlbWVudC5vZmZzZXRUb3A7XG4gICAgICAgIHdoaWxlIChlbGVtZW50Lm9mZnNldFBhcmVudCkge1xuICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50Lm9mZnNldFBhcmVudDtcbiAgICAgICAgICB0b3AgKz0gZWxlbWVudC5vZmZzZXRUb3A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvcDtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6ICdpc1Zpc2libGUnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzVmlzaWJsZShib3gpIHtcbiAgICAgICAgdmFyIG9mZnNldCA9IGJveC5nZXRBdHRyaWJ1dGUoJ2RhdGEtd293LW9mZnNldCcpIHx8IHRoaXMuY29uZmlnLm9mZnNldDtcbiAgICAgICAgdmFyIHZpZXdUb3AgPSB0aGlzLmNvbmZpZy5zY3JvbGxDb250YWluZXIgJiYgdGhpcy5jb25maWcuc2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCB8fCB3aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICAgIHZhciB2aWV3Qm90dG9tID0gdmlld1RvcCArIE1hdGgubWluKHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQsIGdldElubmVySGVpZ2h0KCkpIC0gb2Zmc2V0O1xuICAgICAgICB2YXIgdG9wID0gdGhpcy5vZmZzZXRUb3AoYm94KTtcbiAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGJveC5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgcmV0dXJuIHRvcCA8PSB2aWV3Qm90dG9tICYmIGJvdHRvbSA+PSB2aWV3VG9wO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2Rpc2FibGVkJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNhYmxlZCgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmNvbmZpZy5tb2JpbGUgJiYgaXNNb2JpbGUobmF2aWdhdG9yLnVzZXJBZ2VudCk7XG4gICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFdPVztcbiAgfSgpO1xuXG4gIGV4cG9ydHMuZGVmYXVsdCA9IFdPVztcbiAgbW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG59KTtcbiJdfQ==
