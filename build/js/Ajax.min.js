var BK=BK||{};BK.Ajax=function(config){var vars="",self=this;if(self.request=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),self.request.onreadystatechange=function(){if(4==self.request.readyState&&200==self.request.status){var ctype=self.request.getResponseHeader("Content-Type"),response;if(ctype.match(/xml/gi)?response=self.request.responseXML:ctype.match(/json/gi)?(eval("var qqq="+self.request.responseText),response=qqq):response=self.request.responseText,config.onComplete){var headers=BK.Ajax.convertHeadersToObject(self.request.getAllResponseHeaders());config.onComplete(response,headers)}}else 4==self.request.readyState&&200!=self.request.status&&config.onFailure&&config.onFailure({text:self.request.responseText,code:self.request.status})},config.params)if(config.params.substr)vars=config.params;else{for(param in config.params)vars+="&"+encodeURIComponent(param)+"="+encodeURIComponent(config.params[param]);vars=vars.substr(1)}self.fire=function(){if("GET"==config.method){vars&&(vars="?"+vars),self.request.open("GET",config.url+vars,!0);for(header in config.headers)self.request.setRequestHeader(header,config.headers[header]);config.xRequestedWith&&self.request.setRequestHeader("X-Requested-With","XMLHttpRequest"),self.request.send(null)}else{self.request.open("POST",config.url,!0);for(header in config.headers)self.request.setRequestHeader(header,config.headers[header]);config.xRequestedWith&&self.request.setRequestHeader("X-Requested-With","XMLHttpRequest"),self.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),self.request.send(vars)}return self},self.abort=function(){self.request.onreadystatechange=null,self.request.abort(),config.onFailure&&config.onFailure({text:self.request.responseText,code:self.request.status})}},BK.Ajax.convertHeadersToObject=function(e){for(var s=e.split("\n"),t={},r=0;r<s.length;r++){var n=s[r].split(": ",2);n.length>1&&(t[n[0]]=n[1])}return t};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFqYXguanMiXSwibmFtZXMiOlsiQksiLCJBamF4IiwiY29uZmlnIiwidmFycyIsInNlbGYiLCJ0aGlzIiwicmVxdWVzdCIsIndpbmRvdyIsIlhNTEh0dHBSZXF1ZXN0IiwiQWN0aXZlWE9iamVjdCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJjdHlwZSIsImdldFJlc3BvbnNlSGVhZGVyIiwicmVzcG9uc2UiLCJtYXRjaCIsInJlc3BvbnNlWE1MIiwiZXZhbCIsInJlc3BvbnNlVGV4dCIsInFxcSIsIm9uQ29tcGxldGUiLCJoZWFkZXJzIiwiY29udmVydEhlYWRlcnNUb09iamVjdCIsImdldEFsbFJlc3BvbnNlSGVhZGVycyIsIm9uRmFpbHVyZSIsInRleHQiLCJjb2RlIiwicGFyYW1zIiwic3Vic3RyIiwicGFyYW0iLCJlbmNvZGVVUklDb21wb25lbnQiLCJmaXJlIiwibWV0aG9kIiwib3BlbiIsInVybCIsImhlYWRlciIsInNldFJlcXVlc3RIZWFkZXIiLCJ4UmVxdWVzdGVkV2l0aCIsInNlbmQiLCJhYm9ydCIsImxpbmVzIiwic3BsaXQiLCJvYmoiLCJpIiwibGVuZ3RoIiwiY29tcG9uZW50cyJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsR0FBS0EsT0FDVEEsR0FBR0MsS0FBTyxTQUFTQyxRQUNmLElBQUlDLEtBQU8sR0FDUEMsS0FBT0MsS0E0Q1gsR0ExQ0FELEtBQUtFLFFBQVdDLE9BQXFCLGVBQ2pDLElBQUlDLGVBQ0osSUFBSUMsY0FBYyxxQkFFdEJMLEtBQUtFLFFBQVFJLG1CQUFxQixXQUM5QixHQUErQixHQUEzQk4sS0FBS0UsUUFBUUssWUFBMEMsS0FBdkJQLEtBQUtFLFFBQVFNLE9BQWUsQ0FDNUQsSUFBSUMsTUFBUVQsS0FBS0UsUUFBUVEsa0JBQWtCLGdCQUN2Q0MsU0FtQkosR0FoQklGLE1BQU1HLE1BQU0sU0FDWkQsU0FBV1gsS0FBS0UsUUFBUVcsWUFJbkJKLE1BQU1HLE1BQU0sV0FDakJFLEtBQUssV0FBYWQsS0FBS0UsUUFBUWEsY0FDL0JKLFNBQVdLLEtBS1hMLFNBQVdYLEtBQUtFLFFBQVFhLGFBSXhCakIsT0FBT21CLFdBQVksQ0FDbkIsSUFBSUMsUUFBVXRCLEdBQUdDLEtBQUtzQix1QkFBdUJuQixLQUFLRSxRQUFRa0IseUJBQzFEdEIsT0FBT21CLFdBQVdOLFNBQVVPLGVBS0QsR0FBM0JsQixLQUFLRSxRQUFRSyxZQUEwQyxLQUF2QlAsS0FBS0UsUUFBUU0sUUFDOUNWLE9BQU91QixXQUFXdkIsT0FBT3VCLFdBQ3hCQyxLQUFNdEIsS0FBS0UsUUFBUWEsYUFDbkJRLEtBQU12QixLQUFLRSxRQUFRTSxVQU0zQlYsT0FBTzBCLE9BR1AsR0FBSTFCLE9BQU8wQixPQUFPQyxPQUNkMUIsS0FBT0QsT0FBTzBCLFdBRWIsQ0FDRCxJQUFLRSxTQUFTNUIsT0FBTzBCLE9BQ2pCekIsTUFBUSxJQUFNNEIsbUJBQW1CRCxPQUFTLElBQU1DLG1CQUFtQjdCLE9BQU8wQixPQUFPRSxRQUlyRjNCLEtBQU9BLEtBQUswQixPQUFPLEdBSTNCekIsS0FBSzRCLEtBQU8sV0FDUixHQUFxQixPQUFqQjlCLE9BQU8rQixPQUFpQixDQUdyQjlCLE9BQU1BLEtBQU8sSUFBTUEsTUFHdEJDLEtBQUtFLFFBQVE0QixLQUFLLE1BQU9oQyxPQUFPaUMsSUFBTWhDLE1BQU0sR0FHNUMsSUFBS2lDLFVBQVVsQyxPQUFPb0IsUUFDbEJsQixLQUFLRSxRQUFRK0IsaUJBQWlCRCxPQUFRbEMsT0FBT29CLFFBQVFjLFNBSXJEbEMsT0FBT29DLGdCQUNQbEMsS0FBS0UsUUFBUStCLGlCQUFpQixtQkFBb0Isa0JBSXREakMsS0FBS0UsUUFBUWlDLEtBQUssVUFFakIsQ0FHRG5DLEtBQUtFLFFBQVE0QixLQUFLLE9BQVFoQyxPQUFPaUMsS0FBSyxHQUd0QyxJQUFLQyxVQUFVbEMsT0FBT29CLFFBQ2xCbEIsS0FBS0UsUUFBUStCLGlCQUFpQkQsT0FBUWxDLE9BQU9vQixRQUFRYyxTQUlyRGxDLE9BQU9vQyxnQkFDUGxDLEtBQUtFLFFBQVErQixpQkFBaUIsbUJBQW9CLGtCQUl0RGpDLEtBQUtFLFFBQVErQixpQkFBaUIsZUFBZ0IscUNBRzlDakMsS0FBS0UsUUFBUWlDLEtBQUtwQyxNQUd0QixPQUFPQyxNQUdYQSxLQUFLb0MsTUFBUSxXQUNUcEMsS0FBS0UsUUFBUUksbUJBQXFCLEtBQ2xDTixLQUFLRSxRQUFRa0MsUUFHVnRDLE9BQU91QixXQUNOdkIsT0FBT3VCLFdBQ0hDLEtBQU10QixLQUFLRSxRQUFRYSxhQUNuQlEsS0FBTXZCLEtBQUtFLFFBQVFNLFdBTW5DWixHQUFHQyxLQUFLc0IsdUJBQXlCLFNBQVNELEdBSXRDLElBSEEsSUFBSW1CLEVBQVFuQixFQUFRb0IsTUFBTSxNQUN0QkMsS0FFS0MsRUFBSSxFQUFHQSxFQUFJSCxFQUFNSSxPQUFRRCxJQUFLLENBQ25DLElBQUlFLEVBQWFMLEVBQU1HLEdBQUdGLE1BQU0sS0FBTSxHQUNsQ0ksRUFBV0QsT0FBUyxJQUNwQkYsRUFBSUcsRUFBVyxJQUFNQSxFQUFXLElBSXhDLE9BQU9IIiwiZmlsZSI6IkFqYXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgQksgPSBCSyB8fCB7fTtcclxuQksuQWpheCA9IGZ1bmN0aW9uKGNvbmZpZyl7XHJcbiAgICB2YXIgdmFycyA9IFwiXCI7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgc2VsZi5yZXF1ZXN0ID0gKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCkgP1xyXG4gICAgICAgIG5ldyBYTUxIdHRwUmVxdWVzdCgpOlxyXG4gICAgICAgIG5ldyBBY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTEhUVFBcIik7XHJcblxyXG4gICAgc2VsZi5yZXF1ZXN0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYgKHNlbGYucmVxdWVzdC5yZWFkeVN0YXRlID09IDQgJiYgc2VsZi5yZXF1ZXN0LnN0YXR1cyA9PSAyMDApIHtcclxuICAgICAgICAgICAgdmFyIGN0eXBlID0gc2VsZi5yZXF1ZXN0LmdldFJlc3BvbnNlSGVhZGVyKFwiQ29udGVudC1UeXBlXCIpO1xyXG4gICAgICAgICAgICB2YXIgcmVzcG9uc2U7XHJcblxyXG4gICAgICAgICAgICAvLyBIZWFkZXIgY29udGFpbnMgWE1MIGluIGl0XHJcbiAgICAgICAgICAgIGlmIChjdHlwZS5tYXRjaCgveG1sL2dpKSkge1xyXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBzZWxmLnJlcXVlc3QucmVzcG9uc2VYTUw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEhlYWRlciBjb250YWlucyBKU09OIGluIGl0XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGN0eXBlLm1hdGNoKC9qc29uL2dpKSl7XHJcbiAgICAgICAgICAgICAgICBldmFsKFwidmFyIHFxcT1cIiArIHNlbGYucmVxdWVzdC5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBxcXE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIE5vdCB4bWwgb3IganNvblxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gc2VsZi5yZXF1ZXN0LnJlc3BvbnNlVGV4dDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gRXhlY3V0ZSBjb21wbGV0ZVxyXG4gICAgICAgICAgICBpZiAoY29uZmlnLm9uQ29tcGxldGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0gQksuQWpheC5jb252ZXJ0SGVhZGVyc1RvT2JqZWN0KHNlbGYucmVxdWVzdC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSk7XHJcbiAgICAgICAgICAgICAgICBjb25maWcub25Db21wbGV0ZShyZXNwb25zZSwgaGVhZGVycyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEVycm9yXHJcbiAgICAgICAgZWxzZSBpZihzZWxmLnJlcXVlc3QucmVhZHlTdGF0ZSA9PSA0ICYmIHNlbGYucmVxdWVzdC5zdGF0dXMgIT0gMjAwKXtcclxuICAgICAgICAgICAgaWYoY29uZmlnLm9uRmFpbHVyZSkgY29uZmlnLm9uRmFpbHVyZSh7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBzZWxmLnJlcXVlc3QucmVzcG9uc2VUZXh0LFxyXG4gICAgICAgICAgICAgICAgY29kZTogc2VsZi5yZXF1ZXN0LnN0YXR1c1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQW55IHBhcmFtcz9cclxuICAgIGlmIChjb25maWcucGFyYW1zKSB7XHJcblxyXG4gICAgICAgIC8vIFBhcmFtcyBpcyBhIHN0cmluZz9cclxuICAgICAgICBpZiAoY29uZmlnLnBhcmFtcy5zdWJzdHIpIHtcclxuICAgICAgICAgICAgdmFycyA9IGNvbmZpZy5wYXJhbXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgeyAvLyBQYXJhbXMgaXMgYW4gb2JqZWN0XHJcbiAgICAgICAgICAgIGZvciAocGFyYW0gaW4gY29uZmlnLnBhcmFtcykge1xyXG4gICAgICAgICAgICAgICAgdmFycyArPSBcIiZcIiArIGVuY29kZVVSSUNvbXBvbmVudChwYXJhbSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChjb25maWcucGFyYW1zW3BhcmFtXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSBleHRyYSBhbXBlcnNhbmRcclxuICAgICAgICAgICAgdmFycyA9IHZhcnMuc3Vic3RyKDEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZWxmLmZpcmUgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmIChjb25maWcubWV0aG9kID09IFwiR0VUXCIpIHtcclxuXHJcbiAgICAgICAgICAgIC8vIFByZXBlbmQgcXVlc3Rpb24gbWFya1xyXG4gICAgICAgICAgICBpZih2YXJzKSB2YXJzID0gXCI/XCIgKyB2YXJzO1xyXG5cclxuICAgICAgICAgICAgLy8gUHJpbWUgYSBHRVQgcmVxdWVzdFxyXG4gICAgICAgICAgICBzZWxmLnJlcXVlc3Qub3BlbihcIkdFVFwiLCBjb25maWcudXJsICsgdmFycywgdHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBTZXQgYWRkaXRpb25hbCBoZWFkZXJzXHJcbiAgICAgICAgICAgIGZvciAoaGVhZGVyIGluIGNvbmZpZy5oZWFkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihoZWFkZXIsIGNvbmZpZy5oZWFkZXJzW2hlYWRlcl0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgcmVxdWVzdCBoZWFkZXJcclxuICAgICAgICAgICAgaWYgKGNvbmZpZy54UmVxdWVzdGVkV2l0aCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJYLVJlcXVlc3RlZC1XaXRoXCIsIFwiWE1MSHR0cFJlcXVlc3RcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFNlbmQgdGhlIHJlcXVlc3RcclxuICAgICAgICAgICAgc2VsZi5yZXF1ZXN0LnNlbmQobnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgeyAvLyBQT1NUIHJlcXVlc3RcclxuXHJcbiAgICAgICAgICAgIC8vIFByaW1lIGEgUE9TVCByZXF1ZXN0XHJcbiAgICAgICAgICAgIHNlbGYucmVxdWVzdC5vcGVuKCdQT1NUJywgY29uZmlnLnVybCwgdHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBTZXQgYWRkaXRpb25hbCBoZWFkZXJzXHJcbiAgICAgICAgICAgIGZvciAoaGVhZGVyIGluIGNvbmZpZy5oZWFkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihoZWFkZXIsIGNvbmZpZy5oZWFkZXJzW2hlYWRlcl0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBBZGQgcmVxdWVzdCBoZWFkZXJcclxuICAgICAgICAgICAgaWYgKGNvbmZpZy54UmVxdWVzdGVkV2l0aCkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5yZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJYLVJlcXVlc3RlZC1XaXRoXCIsIFwiWE1MSHR0cFJlcXVlc3RcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIE5lY2Vzc2FyeSBQT1NUIGhlYWRlcnNcclxuICAgICAgICAgICAgc2VsZi5yZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LXR5cGVcIiwgXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIik7XHJcblxyXG4gICAgICAgICAgICAvLyBTZW5kIHRoZSByZXF1ZXN0XHJcbiAgICAgICAgICAgIHNlbGYucmVxdWVzdC5zZW5kKHZhcnMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHNlbGY7XHJcbiAgICB9XHJcblxyXG4gICAgc2VsZi5hYm9ydCA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgc2VsZi5yZXF1ZXN0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XHJcbiAgICAgICAgc2VsZi5yZXF1ZXN0LmFib3J0KCk7XHJcblxyXG4gICAgICAgIC8vIEZpcmUgZmFpbHVyZSBmdW5jdGlvblxyXG4gICAgICAgIGlmKGNvbmZpZy5vbkZhaWx1cmUpIHtcclxuICAgICAgICAgICAgY29uZmlnLm9uRmFpbHVyZSh7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBzZWxmLnJlcXVlc3QucmVzcG9uc2VUZXh0LFxyXG4gICAgICAgICAgICAgICAgY29kZTogc2VsZi5yZXF1ZXN0LnN0YXR1c1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbkJLLkFqYXguY29udmVydEhlYWRlcnNUb09iamVjdCA9IGZ1bmN0aW9uKGhlYWRlcnMpIHtcclxuICAgIHZhciBsaW5lcyA9IGhlYWRlcnMuc3BsaXQoXCJcXG5cIik7XHJcbiAgICB2YXIgb2JqID0ge307XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBjb21wb25lbnRzID0gbGluZXNbaV0uc3BsaXQoXCI6IFwiLCAyKTtcclxuICAgICAgICBpZiAoY29tcG9uZW50cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgIG9ialtjb21wb25lbnRzWzBdXSA9IGNvbXBvbmVudHNbMV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBvYmo7XHJcblxyXG59XHJcbiJdfQ==
